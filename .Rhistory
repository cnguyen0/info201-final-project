Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
setwd("~/Desktop/info201/info201-final-project/scripts")
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
#data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data$comfort <- as.character(data$comfort)
data[data$comfort == ""] <- "No response"
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
setwd("~/Desktop/info201/info201-final-project")
runApp()
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp()
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
data <- data.frame(data, stringsAsFactors = FALSE)
data[data == ""] <- "No response"
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
View(data)
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp()
