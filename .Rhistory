output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("httr")
library("httr")
library(dplyr)
library(jsonlite)
zip.code <- '98105'
base.url <- "https://congress.api.sunlightfoundation.com/"
```
```{r reporting district, echo= FALSE}
query.params <- list(zip = zip.code)
district.response <- GET(paste0(base.url, "districts/locate/"), query = query.params)
district.body <- content(district.response, "text")
district.data <- fromJSON(district.body)
district.df <- as.data.frame(district.data)
district.num <- district.df$results.district
district.state <- district.df$results.state
```
In `r district.state` State, zip code = `r zip.code`, there are `r district.num` congressional districts.
```{r representatives table, echo= FALSE}
representatives.response <- GET(paste0(base.url, "legislators/locate/"), query = query.params)
representatives.body <- content(representatives.response, "text")
representatives.data <- fromJSON(representatives.body)
representatives.df <- as.data.frame(representatives.data)
representatives.df <- flatten(representatives.df)
representatives.relevant <- select(representatives.df, results.first_name, results.last_name, contains("title"), contains("party"), contains("chamber"), contains("phone"))
names <- c("First Name", "Last Name", "Title", "Party", "Chamber", "Phone", "Website", "Twitter")
websites <- representatives.df$results.website
markdown.websites <- paste0("[link](", websites, ")")
representatives.relevant$results.website <- markdown.websites
twitter <- representatives.df$results.twitter_id
markdown.twitter <- paste0("[link](https://www.twitter.com/", twitter, "/)")
representatives.relevant$results.twitter <- markdown.twitter
knitr::kable(representatives.relevant, format = "markdown", col.names = names)
```
```{r summary committee information, echo= FALSE}
Committee <- function(rep.id) {
comm.query.params <- list(member_ids = rep.id)
comm.response <- GET(paste0(base.url, "committees/"), query = comm.query.params)
comm.body <- content(comm.response, "text")
comm.data <- fromJSON(comm.body)
comm.df <- as.data.frame(comm.data) %>% flatten()
return(comm.df)
}
list.id <- list(representatives.df[1, "results.bioguide_id"], representatives.df[2, "results.bioguide_id"], representatives.df[3, "results.bioguide_id"])
committee.info <- lapply(list.id, Committee)
jayapal.committee.info <- data.frame(committee.info[1])
murray.committee.info <- data.frame(committee.info[2])
cantwell.committee.info <- data.frame(committee.info[3])
representatives.relevant$No.of.Committees <- c(nrow(jayapal.committee.info), nrow(murray.committee.info), nrow(cantwell.committee.info))
par(mai = c(1, 2, 1, 1))
barplot(main = "Committees Served by Each Rep", height = representatives.relevant$No.of.Committees, horiz = TRUE, xlab = "# Committees", names.arg = paste(representatives.relevant$results.first_name, representatives.relevant$results.last_name), las = 1)
```
```{r in-depth committee information, echo= FALSE}
#In this section, you'll (again) use the /committees API endpoint to access more in-depth information about a particular committee that one of your representatives serves on. To do so, follow these steps
#Using your committee information from above, programmatically select one committee from your data that is not a subcommittee. Be sure to track which representative is on that committee.
#Using your selected committee's id, you'll want to query all members of that committee (i.e, fields="members"). Make sure to return all results (not just the first page)
#The information returned from this query is (unfortunately) is a pretty messy format. I found the following to be a great way to access the information I wanted (where res is the result returned from the API):
#body <- fromJSON(content(res,"text"))$results$members[[1]] %>% flatten()
```
View(jayapal.committee.info)
committee.id <- select(jayapal.committee.info, committee.id, results.subcommittee) %>% filter(results.subcommittee == FALSE)
committee.id <- select(jayapal.committee.info, results.committee_id, results.subcommittee) %>% filter(results.subcommittee == FALSE)
View(committee.id)
committee.id <- committee.id[1, "results.committee_id"]
committee.id <- select(jayapal.committee.info, results.committee_id, results.subcommittee) %>% filter(results.subcommittee == FALSE)%>% committee.id[1, "results.committee_id"]
rep.name <- "jayapal"
committee.id <- select(jayapal.committee.info, results.committee_id, results.subcommittee) %>% filter(results.subcommittee == FALSE)
committee.id <- committee.id[1, "results.committee_id"]
in.depth.query.params <- list(fields = "members")
in.depth.response <- GET(paste0(base.url, "committees"), query = in.depth.query.params)
in.depth.body <- fromJSON(content(in.depth.response,"text"))$results$members[[1]] %>% flatten()
in.depth.df <- as.data.frame(in.depth.body)
View(in.depth.df)
View(in.depth.body)
View(in.depth.body)
chairman <- select(in.depth.body, contains("name"), contains("title"))
View(district.df)
View(chairman)
chairman <- select(in.depth.body,results.last_name, results.first_name, contains("title"))
chairman <- select(in.depth.body,legislator.last_name, legislator.first_name, contains("title"))
chairman <- select(in.depth.body,legislator.last_name, legislator.first_name, contains("title")) %>% filter(legislator.title == 'Chairman')
chairman <- select(in.depth.body,legislator.last_name, legislator.first_name, contains("title"))
chairman <- select(in.depth.body,legislator.last_name, legislator.first_name, title) %>% filter(title == "Chairman")
chairman.name <- paste(chairman$legislator.first_name, chairman$legislator.last_name)
num.people <- nrows(in.depth.body)
num.people <- summarize(nrows(in.depth.body))
num.people <- summarize(n(in.depth.body))
num.people <- n(in.depth.body)
num.people <- summarise(n(in.depth.body))
num.people <- in.depth.body %>% summarise(n())
View(num.people)
number.in.committee <- num.people$`n()`
legislators <- do.call(rbind, lapply(committee.info, data.frame, stringsAsFactors = FALSE))
legislators <- do.call(cbind, lapply(committee.info, data.frame, stringsAsFactors = FALSE))
legislators <- do.call(rbind, cbind, lapply(committee.info, data.frame, stringsAsFactors = FALSE))
legislators <- do.call(cbind, lapply(committee.info, data.frame, stringsAsFactors = FALSE))
knitr::kable(representatives.relevant, format = "markdown", col.names = names)
rep.name <- "cantwell"
committee.id <- select(cantwell.committee.info, results.committee_id, results.subcommittee) %>% filter(results.subcommittee == FALSE)
committee.id <- committee.id[1, "results.committee_id"]
in.depth.query.params <- list(fields = "members")
in.depth.response <- GET(paste0(base.url, "committees"), query = in.depth.query.params)
in.depth.body <- fromJSON(content(in.depth.response,"text"))$results$members[[1]] %>% flatten()
#Who is the chair of the committee (first and last name)?
chairman <- select(in.depth.body,legislator.last_name, legislator.first_name, title) %>% filter(title == "Chairman")
chairman.name <- paste(chairman$legislator.first_name, chairman$legislator.last_name)
#How many people are on the committee?
num.people <- in.depth.body %>% summarise(n())
number.in.committee <- num.people$`n()`
View(in.depth.body)
rep.name <- "cantwell"
committee.id <- select(cantwell.committee.info, results.committee_id, results.subcommittee) %>% filter(results.subcommittee == FALSE)
committee.id <- committee.id[2, "results.committee_id"]
in.depth.query.params <- list(fields = "members")
in.depth.response <- GET(paste0(base.url, "committees"), query = in.depth.query.params)
in.depth.body <- fromJSON(content(in.depth.response,"text"))$results$members[[1]] %>% flatten()
#Who is the chair of the committee (first and last name)?
chairman <- select(in.depth.body,legislator.last_name, legislator.first_name, title) %>% filter(title == "Chairman")
chairman.name <- paste(chairman$legislator.first_name, chairman$legislator.last_name)
#How many people are on the committee?
num.people <- in.depth.body %>% summarise(n())
number.in.committee <- num.people$`n()`
View(in.depth.body)
library(cars)
library(emptycars)
emptycars
library(plotly)
install.packages(plotly)
library(plotly)
install.packages(plot_ly)
library(plotly)
library("plotly")
mtcars
install.packages("plotly")
library("plotly")
plot_ly(data = mtcars, x = ~mpg, y = wt)
plot_ly(data = mtcars, x = ~mpg, y = ~wt)
library("plotly")
library(dplyr)
library("httr")
library(dplyr)
library(jsonlite)
setwd("~/Desktop/INFO201/a6-mapping-shootings-meghagoel97")
shooting.data <- read.csv('~/Desktop/INFO201/a6-mapping-shootings/data/any_drinking.csv', stringsAsFactors = FALSE)
shooting.data <- read.csv('~/Desktop/INFO201/a6-mapping-shootings-meghagoel97/data/any_drinking.csv', stringsAsFactors = FALSE)
shooting.data <- read.csv('~/Desktop/INFO201/a6-mapping-shootings-meghagoel97/data/shootings-2016.csv', stringsAsFactors = FALSE)
View(shooting.data)
View(shooting.data)
total.shootings <- nrow(shooting.data)
total.lives.lost <- total.shootings %>% select(killed) %>% sum()
total.lives.lost <- total.shootings %>% select(killed) %>% cumsum()
total.lives.lost <- total.shootings %>% select('killed') %>% cumsum()
total.lives.lost <- shooting.data %>% select('killed') %>% cumsum()
total.lives.lost <- shooting.data %>% select(killed) %>% cumsum()
View(total.lives.lost)
total.lives.lost <- shooting.data %>% select(killed) %>% summarise(sum())
View(total.lives.lost)
total.lives.lost <- shooting.data %>% select(killed) %>% summarise(cumsum())
total.lives.lost <- shooting.data %>% select(killed) %>% cumsum()
View(total.lives.lost)
total.lives.lost <- sum(shooting.data$killed)
total.lives.injured <-sum(shooting.data$injured)
num.unique.states.affected <- filter(shooting.data, unique(state))
num.unique.states.affected <- filter(shooting.data, state)
num.unique.states.affected <- select(shooting.data, state)
View(shooting.data)
View(num.unique.states.affected)
num.unique.states.affected <- select(shooting.data, state) %>% filter(unique(state))
num.unique.states.affected <- select(shooting.data, state) %>% filter(state == unique(state))
num.unique.states.affected <- select(shooting.data, unique(state)
View(num.unique.states.affected)
View(num.unique.states.affected)
View(shooting.data)
num.unique.states.affected <- select(shooting.data, unique(state))
View(num.unique.states.affected)
num.unique.states.affected <- unique(shooting.data$state)
num.unique.states.affected <- unique(shooting.data$state) %>% as.data.frame()
View(num.unique.states.affected)
unique.states.affected <- unique(shooting.data$state) %>% as.data.frame()
num.unique.states.affected <- nrow(unique.states.affected)
most.affected <- filter(shooting.data, killed > 5 | injured > 5)
most.affected <- filter(shooting.data, killed >= 5 | injured >= 5)
View(most.affected)
most.affected.killed <- filter(shooting.data, killed >= 5)
most.affected.injured <- filter(shooting.data, injured >= 5)
max.killed <- filter(most.affected.killed, killed == max(killed))
max.injured <- filter(most.affected.injured, injured == max(injured))
View(max.injured)
View(max.killed)
date.most.shootings <- mutate(shooting.data, total.affected = injured + killed)
most.shootings <- mutate(shooting.data, total.affected = injured + killed)
shooting.d <- mutate(shooting.data, total.affected = injured + killed)
View(shooting.d)
num.total.affected <- sum(shooting.data$total.affected)
shooting.d <- mutate(shooting.data, total.affected = injured + killed)
num.total.affected <- sum(shooting.data$total.affected)
num.total.affected <- sum(shooting.d$total.affected)
num.total.affected <- sum(shooting.d$total.affected)
shooting.data <- mutate(shooting.data, total.affected = injured + killed)
setwd("~/Desktop/INFO201/a6-mapping-shootings-meghagoel97")
shooting.data <- read.csv('~/Desktop/INFO201/a6-mapping-shootings-meghagoel97/data/shootings-2016.csv', stringsAsFactors = FALSE)
total.shootings <- nrow(shooting.data)
total.lives.lost <- sum(shooting.data$killed)
total.lives.injured <-sum(shooting.data$injured)
unique.states.affected <- unique(shooting.data$state) %>% as.data.frame()
num.unique.states.affected <- nrow(unique.states.affected)
most.affected.killed <- filter(shooting.data, killed >= 5)
most.affected.injured <- filter(shooting.data, injured >= 5)
max.killed <- filter(most.affected.killed, killed == max(killed))
max.injured <- filter(most.affected.injured, injured == max(injured))
max.city.name <- max.injured$city
max.state.name <- max.injured$state
shooting.data <- mutate(shooting.data, total.affected = injured + killed)
num.total.affected <- sum(shooting.data$total.affected)
shooting.date.relevant <- select(shooting.data, date, total.affected) %>% filter(date, total.affected = sum(total.affected))
shooting.date.relevant <- select(shooting.data, date, total.affected) %>% filter(date, total.affected == sum(total.affected))
shooting.date.relevant <- select(shooting.data, date, total.affected) %>% filter(date, summarise(total.affected))
shooting.date.relevant <- select(shooting.data, date, total.affected) %>% filter(date, summarise(cumsum(total.affected)))
shooting.date.relevant <- select(shooting.data, date, total.affected) %>% filter(date, summarise(cumall(total.affected)))
shooting.date.relevant <- select(shooting.data, date, total.affected) %>% filter(date)
shooting.date.relevant <- select(shooting.data, date, total.affected) %>% filter(unique(date))
shooting.date.relevant <- select(shooting.data, date, total.affected
shooting.date.relevant <- select(shooting.data, date, total.affected)
data.set <- read.csv('~/Desktop/INFO201/a7-collaboration-aa3/data/intro-survey.csv', stringsAsFactors = FALSE)
data.set <- read.csv('~/Desktop/INFO201/a7-collaboration-aa3/data/intro-survey.csv', stringsAsFactors = FALSE)
library(dplyr)
library(ggplot2)
View(data.set)
relevant <- select(data.set, contains("countries"), contains("siblings"), contains("Seahawks"))
View(relevant)
relevant <- select(data.set, contains("countries"), contains("siblings"), contains("standing"))
View(relevant)
chart.3 <- ggplot(data = relevant) +
geom_polygon(aes(x = contains("countries"), y = contains("siblings"), group = contains("standing"))) +
scale_fill_manual(values = c("blue", "red")) +
coord_quickmap()
ggplot(data = relevant) +
geom_polygon(aes(x = contains("countries"), y = contains("siblings"), group = contains("standing"))) +
scale_fill_manual(values = c("blue", "red")) +
coord_quickmap()
relevant <- select(data.set, countries = contains("countries"), siblings = contains("siblings"), standing = contains("standing"))
View(relevant)
ggplot(data = relevant) +
geom_polygon(aes(x = countries, y = siblings, group = standing)) +
scale_fill_manual(values = c("blue", "red")) +
coord_quickmap()
ggplot(data = relevant) +
geom_polygon(aes(x = countries, y = siblings, group = group)) +
scale_fill_manual(values = c("blue", "red")) +
coord_quickmap()
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
scale_fill_manual(values = c("blue", "red")) +
coord_quickmap()
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
scale_y_log10()
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
scale_y_log5()
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
scale_fill_manual( values = standings)
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
scale_fill_manual( values = "royalblue")
ggplot(data = relevant) +
geom_dotplot(mapping = aes(x = countries, y = siblings)) +
scale_fill_manual( values = "royalblue")
ggplot(data = relevant) +
geom_dotplot(mapping = aes(x = countries, y = siblings)) +
scale_fill_manual( values = c("royalblue"))
ggplot(data = relevant) +
geom_dotplot(mapping = aes(x = countries, y = siblings)) +
scale_fill_brewer(palette = "Blues")
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings))
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
stat_summary(fun.y = mean, geom = "point", size = 2, color = "red")
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
coord_flip() +
stat_summary(fun.y = mean, geom = "point", size = 2, color = "red")
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
stat_summary(fun.y = mean, geom = "point", size = 2, color = "red")
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings))
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
stat_summary(fun.y = median(siblings), geom = "point", size = 2, color = "red")
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
stat_summary(fun.y = median("siblings"), geom = "point", size = 2, color = "red")
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
stat_summary(fun.y = median, geom = "point", size = 2, color = "red")
DataSummary <- function(x) {
m <- mean(x)
ymin <- m-sd(x)
ymax <- m+sd(x)
return(c(y=m,ymin=ymin,ymax=ymax))
}
ggplot(data = relevant) +
geom_violin(mapping = aes(x = countries, y = siblings)) +
stat_summary(fun.data = DataSummary)
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin() +
stat_summary(fun.data = DataSummary)
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin() +
coord_flip() +
stat_summary(fun.data = DataSummary)
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin() +
geom_dotplot(binaxis = 'y', stackdir = 'center', dotsize = 1)
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin() +
geom_dotplot(binaxis = 'x', stackdir = 'center', dotsize = 1)
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin() +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin() +
geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_color_brewer(palette = "Blues")
ggplot(data = relevant, aes(x = countries, y = siblings, color = countries)) +
geom_violin() +
geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_color_brewer(palette = "Blues")
ggplot(data = relevant, aes(x = countries, y = siblings, color = countries)) +
geom_violin() +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = countries, y = siblings, color = countries)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = countries, y = siblings, color = countries)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_color_brewer(palette = "Blues")
ggplot(data = relevant, aes(x = countries, y = siblings, color = countries)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2))
relevant <- select(data.set, countries = contains("countries"), siblings = contains("siblings"), standing = contains("standing")) %>% group_by(siblings)
ggplot(data = relevant, aes(x = countries, y = siblings, color = countries)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = siblings, y = countries, color = countries)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = countries, y = siblings, color = countries)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = countries, y = siblings, color = standings)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(trim = FALSE) +
geom_jitter(shape=16, position=position_jitter(0.2))
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(trim = FALSE) +
coord_flip()
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(trim = FALSE)
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(trim = FALSE) +
scale_x_log10()
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(trim = FALSE)
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin()
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin() + scale_x_log10()
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin()
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin() +
geom_dotplot(binaxis='y', stackdir='center',
position=position_dodge(1))
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin() +  geom_boxplot(width=0.1, fill="white")+
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin() +  geom_boxplot(width=0.1, fill="white")
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin()
ggplot(data = relevant, aes(x = countries, y = standing, color = sibling)) +
geom_violin()
ggplot(data = relevant, aes(x = countries, y = standing, color = siblings)) +
geom_violin()
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing")
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing")
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(scale = standing, trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing")
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing")
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(scale = "area", size = standing, trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing")
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(scale = "area", size = 2, trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing")
ggplot(data = relevant, aes(x = countries, y = siblings, color = standing)) +
geom_violin(scale = "area", weight = 1, trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing")
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, alpha = standing) +
labs(title = "Plot of countries travelled by the number of siblings, divided by Standing", )
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries")
ggplot(data = relevant, aes(x = countries, y = siblings, fill = "#999999")) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries")
ggplot(data = relevant, aes(x = countries, y = siblings, color = "#999999")) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries")
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
p + scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings, fill = '#999999')) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings, fill = darkblue)) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings, fill = "darkblue")) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + scale_fill_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings, fill = '#A4A4A4')) +
geom_violin(scale = "area", trim = FALSE) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, , fill = '#A4A4A4') +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, , fill = "darkblue") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, , fill = "blue") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, , fill = "deepskyblue") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
scale_color_grey() + theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "gray") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "deepskyblue", color = "darkblue") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries") +
theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "deepskyblue", color = "darkblue") +
geom_boxplot(width=0.1, fill="white") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries", y = "No. of Siblings") +
theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "deepskyblue", color = "darkblue") +
geom_boxplot(width=0.01, fill="white") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries", y = "No. of Siblings") +
theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "deepskyblue", color = "darkblue") +
geom_boxplot(fill="white") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries", y = "No. of Siblings") +
theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "deepskyblue", color = "darkblue") +
geom_boxplot(width=0.1) +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries", y = "No. of Siblings") +
theme_classic()
ggplot(data = relevant, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "deepskyblue", color = "darkblue") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries", y = "No. of Siblings") +
theme_classic()
Chart3 <- function(value.set) {
ggplot(data = value.set, aes(x = countries, y = siblings)) +
geom_violin(scale = "area", trim = FALSE, fill = "deepskyblue", color = "darkblue") +
labs(title = "Plot of countries travelled by the number of siblings", x = "No. of Countries", y = "No. of Siblings") +
theme_classic()
}
Chart3(relevant)
setwd("~Desktop/INFO201/a7-collaboration-aa3")
shiny::runApp('Desktop/INFO201/a8-building-apps-meghagoel97')
runApp('Desktop/INFO201/info201-final-project')
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data[data == ""] <- "No response"
View(data)
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
runApp('~/Desktop/info201/info201-final-project')
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
#data <- data %>% filter(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. != "",
#                        Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. != "")
#data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
data$comfort <- as.character(data$comfort)
data[data$comfort == ""] <- "No response"
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
setwd("~/Desktop/info201/info201-final-project")
runApp()
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
data <- data.frame(data, stringsAsFactors = FALSE)
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp()
library(dplyr)
library(stringr)
library(plotly)
# Creates heatmap of relationship between number of diagnosis and comfort with speaking to supervisor
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
data <- data.frame(data, stringsAsFactors = FALSE)
data[data == ""] <- "No response"
# selects data focusing on either "currently diagnosed with mental health disorder" or
# "was diagnosed with mental health disorders by a professional to dataframe "data
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
# removes uneeded columns from dataframe "data" depending on if asking for comfort speaking to supervisor
# about mental health disorder vs mental health issues
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
View(data)
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
data <- group_by(data, comfort, num.conditions) %>% summarise(n = n())
plot <- plot_ly(data = data,
x = ~num.conditions,
y = ~comfort,
z = ~n,
type = "heatmap") %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
# Counts number of diagnosis per obersevation
# precondition: diagnosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
NumDiagnosis <- function(input) {
return(str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
runApp()
