View(yes)
yes.mental < filter(comfort.level, grepl(Yes, Mental)) %>%
count() %>%
as.numerc()
yes.mental <- filter(comfort.level, grepl(Yes, Mental)) %>%
count() %>%
as.numerc()
filtered <- filter(data, grepl(Class, Ã¯..What.is.your.current.class.standing.)) %>%
as.data.frame()
yes.mental <- filter(comfort.level, grepl(Yes, Mental)) %>%
count() %>%
as.numeric()
library("dplyr", lib.loc="~/R/win-library/3.3")
yes.mental <- filter(comfort.level, grepl(Yes, Mental)) %>%
count() %>%
as.numeric()
yes.mental <- filter(comfort.level, grepl("Yes", Mental)) %>%
count() %>%
as.numeric()
maybe.mental <- filter(comfort.level, grepl("Maybe", Mental)) %>%
count() %>%
as.numeric()
no.mental <- filter(comfort.level, grepl("No", Mental)) %>%
count() %>%
as.numeric()
yes.physical <- filter(comfort.level, grepl("Yes", Physical)) %>%
count() %>%
as.numeric()
physical <- c(yes.physical, maybe.physical, no.physical)
yes.physical <- filter(comfort.level, grepl("Yes", Physical)) %>%
count() %>%
as.numeric()
maybe.physical <- filter(comfort.level, grepl("Maybe", Physical)) %>%
count() %>%
as.numeric()
no.physical <- filter(comfort.level, grepl("No", Physical)) %>%
count() %>%
as.numeric()
physical <- c(yes.physical, maybe.physical, no.physical)
comfort.level.num <- data.frame(mental, physical)
mental <- c(yes.mental, maybe.mental, no.mental)
comfort.level.num <- data.frame(mental, physical)
View(data)
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% select(If.yes..what.condition.s..have.you.been.diagnosed.with., If.maybe..what.condition.s..do.you.believe.you.have.) %>% View()
library(dplyr)
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% select(If.yes..what.condition.s..have.you.been.diagnosed.with., If.maybe..what.condition.s..do.you.believe.you.have.) %>% View()
data %>% select(If.yes..what.condition.s..have.you.been.diagnosed.with.)
stringr::str_split("(Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", "|")
stringr::str_split_fixed("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc), "|")
stringr::str_split_fixed("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", "|")
stringr::str_split_fixed("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", "|", n = Inf)
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "|")
stringr::str_split("Hello everybody | my name is | name", pattern = "|")
stringr::str_split("Hello everybody & my name is & name", pattern = "&")
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\|")
stringr::str_replace("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "|", replacement = "&")
stringr::str_replace("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "|", replacement = "&")
stringr::str_replace("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "A", replacement = "@")
stringr::str_replace("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "o", replacement = "@")
stringr::str_replace_all("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "|", replacement = "&")
strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", split = "\\|and")
strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", split = "\\|and", fixed = TRUE)
strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", split = "\\|", fixed = TRUE)
strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", split = "\\|", fixed = TRUE)
strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", split = ")\\|", fixed = TRUE)
strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", split = "\\)\\|", fixed = TRUE)
stringr::str_replace_all("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|" replacement = "&")
stringr::str_replace_all("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|", replacement = "&")
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)&Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "&")
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|")
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)"), pattern = "\\|")
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|")
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|")
c("i", "2", "3") %>% length()
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|") %>% length()
stringr::str_split("Anxiety Disorder (Generalized, Social, Phobia, etc)&Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "&") %>% length()
unlist(strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|", fixed = TRUE))
unlist(strsplit("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", "\\|", fixed = TRUE))
stringr::str_split("Hello&My name& is &This is my name", "&")
stringr::str_split("Hello&My name& is &This is my name", "&") %>% length()
stringr::str_split_fixed("Hello&My name is &This is my name", "&")
stringr::str_split_fixed("Hello&My name is &This is my name", "&", n = Inf)
stringr::str_split_fixed("Hello&My name is &This is my name", "&", n = Inf) %>% length()
stringr::str_split_fixed("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|", n = Inf)
stringr::str_split_fixed("Anxiety Disorder (Generalized, Social, Phobia, etc)|Mood Disorder (Depression, Bipolar Disorder, etc)", pattern = "\\|", n = Inf) %>% length()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% select(If.yes..what.condition.s..have.you.been.diagnosed.with., If.maybe..what.condition.s..do.you.believe.you.have.) %>% View()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% paste(data$If.yes..what.condition.s..have.you.been.diagnosed.with., data$If.maybe..what.condition.s..do.you.believe.you.have.) %>% View()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% select(If.yes..what.condition.s..have.you.been.diagnosed.with.) %>% length()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% select(If.yes..what.condition.s..have.you.been.diagnosed.with.) %>% rnow()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% select(If.yes..what.condition.s..have.you.been.diagnosed.with.) %>% nrow()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% select(If.maybe..what.condition.s..do.you.believe.you.have.) %>% nrow()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% paste(select(If.yes..what.condition.s..have.you.been.diagnosed.with.), select(If.maybe..what.condition.s..do.you.believe.you.have.))
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% paste(data$If.yes..what.condition.s..have.you.been.diagnosed.with., data$If.maybe..what.condition.s..do.you.believe.you.have.)
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% paste(data$If.yes..what.condition.s..have.you.been.diagnosed.with., data$If.maybe..what.condition.s..do.you.believe.you.have.) %>% View()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% tidyr::unite(If.yes..what.condition.s..have.you.been.diagnosed.with., If.maybe..what.condition.s..do.you.believe.you.have.) %>% View*()
data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>% tidyr::unite(If.yes..what.condition.s..have.you.been.diagnosed.with., If.maybe..what.condition.s..do.you.believe.you.have.) %>% View()
data <- read.csv('./mental-heath-in-tech-2016.csv')
data <- read.csv('./mental-heath-in-tech-2016.csv')
setwd("~/Desktop/info201/etc folder")
data <- read.csv('./mental-heath-in-tech-2016.csv')
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
If.maybe..what.condition.s..do.you.believe.you.have.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
View(data)
colnames(data) <- c("yes.condition", "maybe.condition", "comfort")
tidyr::unite(data, yes.condition, maybe.condition) %>% View()
data <- tidyr::unite(data, yes.condition, maybe.condition)
data <- read.csv('./mental-heath-in-tech-2016.csv')
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. != "No") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("yes.condition", "comfort")
data <- read.csv('./mental-heath-in-tech-2016.csv')
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("yes.condition", "comfort")
colnames(data) <- c("diagonosis.status", "comfort")
stringr::str_split_fixed(data$diagonosis.status, pattern = "\\|", n = Inf) %>% View()
data$diagonosis.status <- stringr::str_split_fixed(data$diagonosis.status, pattern = "\\|", n = Inf) %>% View()
data <- read.csv('./mental-heath-in-tech-2016.csv')
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("diagonosis.status", "comfort")
temp <- stringr::str_split_fixed(data$diagonosis.status, pattern = "\\|", n = Inf) %>% data.frame()
View(temp)
temp <- stringr::str_split_fixed(data$diagonosis.status, pattern = "\\|", n = Inf) %>% length()
temp <- stringr::str_split_fixed(data$diagonosis.status, pattern = "\\|", n = Inf) %>% data.frame()
temp <- stringr::str_split_fixed(data$diagonosis.status, pattern = "\\|", n = Inf) %>% unique()
View(temp)
lapply(data$diagonosis.status, stringr::str_split_fixed(pattern = "\\|", n = Inf))
lapply(stringr::str_split_fixed(data$diagonosis.status, pattern = "\\|", n = Inf))
SplitDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf))
}
temp <- lapply(data$diagonosis.status, SplitDiagnosisList)
temp <- lapply(data$diagonosis.status, SplitDiagnosisList) %>% View()
data <- read.csv('./mental-heath-in-tech-2016.csv')
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("diagonosis.status", "comfort")
temp <- lapply(data$diagonosis.status, SplitDiagnosisList) %>% View()
SplitDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf))
}
temp <- lapply(data$diagonosis.status, SplitDiagnosisList) %>% View()
data <- read.csv('./mental-heath-in-tech-2016.csv')
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("diagonosis.status", "comfort")
temp <- lapply(data$diagonosis.status, SplitDiagnosisList) %>% View()
temp <- lapply(data$diagonosis.status, SplitDiagnosisList)
View(temp)
temp <- lapply(data$diagonosis.status, SplitDiagnosisList) %>% data.frame()
View(temp)
temp <- sapply(data$diagonosis.status, SplitDiagnosisList)
View(temp)
temp <- sapply(data$diagonosis.status, SplitDiagnosisList) %>% data.frame()
library(dplyr)
temp <- temp %>% plyr::ldply(temp)
temp <- plyr::ldply(data$diagonosis.status, SplitDiagnosisList)
View(temp)
temp <- sapply(data$diagonosis.status, SplitDiagnosisList)
temp <- plyr::ldply(data$diagonosis.status, SplitDiagnosisList)
temp <- sapply(data$diagonosis.status, SplitDiagnosisList)
temp <- SplitDiagnosisList(data$diagonosis.status)
View(temp)
setwd("~/Desktop/info201/info201-final-project/scripts")
df <- data.frame(matrix(unlist(temp), nrow = nrow(data), byrow=T),stringsAsFactors=FALSE)
View(df)
data <- read.csv('../Data/mental-heath-in-tech-2016.csv') #will remove later
DiagonosisWillingness <- function(data, diagonosis.status) {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("diagonosis.status", "comfort")
#create list of dataframes of diagnosis of a
temp <- SplitDiagnosisList(data$diagonosis.status)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList)
}
SplitDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf))
}
temp <- SplitDiagnosisList(data$diagonosis.status)
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
temp <- SplitDiagnosisList(data$diagonosis.status)
SplitDiagnosisList()litDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf))
}
library(dplyr)
library(dplyr)
data <- read.csv('../Data/mental-heath-in-tech-2016.csv') #will remove later
DiagonosisWillingness <- function(data, diagonosis.status) {
# selects observations that currently have mental health disorder
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("diagonosis.status", "comfort")
#create list of dataframes of diagnosis per observation
temp <- SplitDiagnosisList(data$diagonosis.status)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList)
}
# Creates a vector of diagonosis
# precondition: diagonosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
SplitDiagnosisList()litDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf))
}
library(stringr)
# selects observations that currently have mental health disorder
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("diagonosis.status", "comfort")
#create list of dataframes of diagnosis per observation
temp <- SplitDiagnosisList(data$diagonosis.status)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList)
# Creates a vector of diagonosis
# precondition: diagonosis listed in format of "<condition 1>|<condition 2>|<condition ...>"
#               each condition is seperated by vertical bar
SplitDiagnosisList()litDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf))
}
temp <- SplitDiagnosisList(data$diagonosis.status)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList)
View(temp)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList) %>% data.frame()
View(diagnosis.list)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList) %>% data.frame() %>% unique()
View(diagnosis.list)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList)
temp <- SplitDiagnosisList(data$diagonosis.status) %>% unique()
View(temp)
temp %>% unique() %>% View()
View(data)
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf) %>% nrow())
SplitDiagnosisList()litDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf) %>% nrow())
}
temp <- SplitDiagnosisList(data$diagonosis.status)
SplitDiagnosisList()litDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf) %>% nrow())
}
SplitDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf) %>% nrow())
}
temp <- SplitDiagnosisList(data$diagonosis.status)
temp <- SplitDiagnosisList(data$diagonosis.status) %>% unique()
View(temp)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList)
View(diagnosis.list)
SplitDiagnosisList <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
temp <- SplitDiagnosisList(data$diagonosis.status)
diagnosis.list <- sapply(data$diagonosis.status, SplitDiagnosisList)
View(temp)
View(diagnosis.list)
NumDiagnosis <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
NumDiagnosis <- function(input) {
return(stringr::str_split_fixed(input, pattern = "\\|", n = Inf) %>% length())
}
#DiagonosisWillingness <- function(data, diagonosis.status) {
#}
# selects observations that currently have mental health disorder
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
colnames(data) <- c("diagonosis.status", "comfort")
#create list of dataframes of diagnosis per observation
temp <- NumDiagnosis(data$diagonosis.status)
diagnosis.list <- sapply(data$diagonosis.status, NumDiagnosis)
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
# selects observations that currently have mental health disorder
#data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
#                 select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
#                        Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
#data <- data %>% filter_(condition.status[1] == "Yes") %>%
#                 select_(condition.status[2], comfort)
#colnames(data) <- c("diagnosis.status", "comfort.level")
temp <- NULL
if (comfort == "disorder") {
temp <- data %>% select(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
} else if (comfort == "issue") {
temp <- data %>% select(Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.)
}
colnames(data) <- "diagnosis.status"
data$comfort <- temp
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
View(data)
plot <- plot_ly(data = na.omit(data),
x = ~comfort,
y = ~num.conditions,
type = "bar",
#mode = "markers",
marker = list(opacity = 0.5)) %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
library(plotly)
library(stringr)
library(dplyr)
shiny::runApp('~/Desktop/info201/info201-final-project')
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
# selects observations that currently have mental health disorder
#data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
#                 select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
#                        Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
#data <- data %>% filter_(condition.status[1] == "Yes") %>%
#                 select_(condition.status[2], comfort)
#colnames(data) <- c("diagnosis.status", "comfort.level")
temp <- NULL
if (comfort == "disorder") {
temp <- data %>% select(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
} else if (comfort == "issue") {
temp <- data %>% select(Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.)
}
colnames(data) <- "diagnosis.status"
data$comfort <- temp
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
View(data)
plot <- plot_ly(data = data,
x = ~comfort,
y = ~num.conditions,
type = "bar",
#mode = "markers",
marker = list(opacity = 0.5)) %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
# selects observations that currently have mental health disorder
#data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
#                 select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
#                        Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
#data <- data %>% filter_(condition.status[1] == "Yes") %>%
#                 select_(condition.status[2], comfort)
#colnames(data) <- c("diagnosis.status", "comfort.level")
temp <- NULL
if (comfort == "disorder") {
temp <- data %>% select(Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
} else if (comfort == "issue") {
temp <- data %>% select(Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
View(temp)
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.)
}
colnames(data) <- "diagnosis.status"
data$comfort <- temp
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
View(data)
plot <- plot_ly(data = data,
x = ~comfort,
y = ~num.conditions,
type = "bar",
#mode = "markers",
marker = list(opacity = 0.5)) %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
runApp('~/Desktop/info201/info201-final-project')
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
# selects observations that currently have mental health disorder
#data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
#                 select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
#                        Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
#data <- data %>% filter_(condition.status[1] == "Yes") %>%
#                 select_(condition.status[2], comfort)
#colnames(data) <- c("diagnosis.status", "comfort.level")
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
View(data)
plot <- plot_ly(data = data,
x = ~comfort,
y = ~num.conditions,
type = "bar",
#mode = "markers",
marker = list(opacity = 0.5)) %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
runApp('~/Desktop/info201/info201-final-project')
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
# selects observations that currently have mental health disorder
#data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
#                 select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
#                        Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
#data <- data %>% filter_(condition.status[1] == "Yes") %>%
#                 select_(condition.status[2], comfort)
#colnames(data) <- c("diagnosis.status", "comfort.level")
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
temp <- data %>% summarize(comfort = comfort, freq = n())
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
plot <- plot_ly(data = temp,
x = ~comfort,
y = ~freq,
type = "bar",
#mode = "markers",
marker = list(opacity = 0.5)) %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
runApp('~/Desktop/info201/info201-final-project')
DiagnosisWillingness <- function(data, curr.or.pro.diag, comfort) {
# selects observations that currently have mental health disorder
#data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
#                 select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
#                        Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..)
#data <- data %>% filter_(condition.status[1] == "Yes") %>%
#                 select_(condition.status[2], comfort)
#colnames(data) <- c("diagnosis.status", "comfort.level")
if (curr.or.pro.diag == "curr") {
data <- data %>% filter(Do.you.currently.have.a.mental.health.disorder. == "Yes") %>%
select(If.yes..what.condition.s..have.you.been.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
} else if (curr.or.pro.diag == "pro") {
data <- data %>% filter(Have.you.been.diagnosed.with.a.mental.health.condition.by.a.medical.professional. == "Yes") %>%
select(If.so..what.condition.s..were.you.diagnosed.with.,
Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s..,
Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s..)
}
if (comfort == "disorder") {
data$Would.you.feel.comfortable.discussing.a.mental.health.disorder.with.your.direct.supervisor.s.. = NULL
} else if (comfort == "issue") {
data$Would.you.have.been.willing.to.discuss.a.mental.health.issue.with.your.direct.supervisor.s.. = NULL
}
colnames(data) <- c("diagnosis.status", "comfort")
temp <- data %>% summarize(comfort = comfort, freq = n())
View(temp)
#create list of number of diagnosis per observation
data$num.conditions <- sapply(data$diagnosis.status, NumDiagnosis)
plot <- plot_ly(data = temp,
x = ~comfort,
y = ~freq,
type = "bar",
#mode = "markers",
marker = list(opacity = 0.5)) %>%
layout(xaxis = list(title = "Number of Diagnosis"),
yaxis = list(title = "Comfortability talking to supervisor"))
return(plot)
}
runApp('~/Desktop/info201/info201-final-project')
